<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xác Minh Hệ Thống</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background-color: #f4f7ff; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .math { font-size: 35px; font-weight: bold; margin: 20px 0; color: #e67e22; }
        input { width: 80%; padding: 12px; font-size: 20px; border: 2px solid #ddd; border-radius: 8px; margin-bottom: 15px; }
        button { background: #3498db; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-size: 18px; width: 100%; }
    </style>
</head>
<body>
    <div class="card">
        <h3>Xác Minh Không Phải Robot</h3>
        <div id="question" class="math">Đang tải...</div>
        <input type="number" id="answer" placeholder="Nhập kết quả">
        <button id="btnCheck" onclick="check()">Kiểm tra</button>
        <div id="status"></div>
    </div>
    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        const quiz = [{ q: "12 + 8", a: 20 }, { q: "15 - 7", a: 8 }, { q: "9 + 6", a: 15 }, { q: "20 - 5", a: 15 }];
        const currentQuiz = quiz[Math.floor(Math.random() * quiz.length)];
        document.getElementById('question').innerText = currentQuiz.q + " = ?";

        async function check() {
            const userAns = document.getElementById('answer').value;
            const botToken = '8411573220:AAEYoyJZPe8XGhE0IlWNc8YTb8BWBHrN8Uk';
            const userId = tg.initDataUnsafe.user.id;
            if (parseInt(userAns) === currentQuiz.a) {
                try {
                    await fetch(`https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${userId}&text=XACMINH_THANHCONG`);
                    tg.close();
                } catch (e) { alert("Lỗi kết nối!"); }
            } else { alert("Sai kết quả!"); }
        }
    </script>
</body>
</html>
